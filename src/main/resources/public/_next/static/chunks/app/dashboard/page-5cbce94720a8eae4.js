(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{24658:(e,t,s)=>{Promise.resolve().then(s.bind(s,36750))},36750:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var r=s(58081),a=s(82149),n=s(19651),c=s(5160),i=s(22486),o=s(24085),l=s(5064),u=s(38194),d=s(51567),m=s(68299),j=s(49011),x=s(40953),g=s(67552);function h(){let e=(0,n.useRouter)(),t=(0,n.useSearchParams)(),{isLicenseValid:s,isInitializing:h,validateLicense:p,logout:w}=(0,g.Y)(),N=t.get("tab")||"weekly",f=t.get("project"),k=t.get("week"),[b,v]=(0,a.useState)(()=>{if(k){let e=new Date(k);if(!isNaN(e.getTime()))return e}return new Date}),[T,S]=(0,a.useState)(f),D=(0,a.useRef)(!1),{statsData:P,projectUrls:y,ignoredProjects:U,loading:R,error:C,idleTimeoutMinutes:E,setIdleTimeoutMinutes:_,settingsLoading:I,fetchStats:L,fetchProjectUrls:O,createProjectUrl:W,updateProjectUrl:A,deleteProjectUrl:M,addIgnoredProject:V,removeIgnoredProject:Y}=(0,x.u)(s);(0,a.useEffect)(()=>{S(f)},[f]),(0,a.useEffect)(()=>{if(k&&!D.current){let e=new Date(k);isNaN(e.getTime())||k===b.toISOString().split("T")[0]||v(e)}},[k,b]);let Z=s=>{D.current=!0;let r=new URLSearchParams(t.toString());s.tab&&r.set("tab",s.tab),void 0!==s.project&&(s.project?r.set("project",s.project):r.delete("project")),s.week&&r.set("week",s.week);let a="".concat(window.location.pathname,"?").concat(r.toString());e.push(a,{scroll:!1}),setTimeout(()=>{D.current=!1},100)},$=e=>{S(e),Z({project:e})};return h?(0,r.jsx)(l.U,{}):s?R?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 p-6 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(i.A,{className:"w-8 h-8 animate-spin mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Loading time tracking data..."})]})}):C?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 p-6 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("p",{className:"text-red-600 mb-4",children:["Error: ",C]}),(0,r.jsxs)(c.$,{onClick:L,children:[(0,r.jsx)(i.A,{className:"w-4 h-4 mr-2"}),"Retry"]})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-stone-50 p-6",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,r.jsx)(u.Y,{idleTimeoutMinutes:E,onIdleTimeoutChange:_,onRefresh:L,onLogout:w,settingsLoading:I}),(0,r.jsx)(d.p,{currentWeek:b,onNavigateWeek:e=>{let t;"current"===e?t=new Date:(t=new Date(b)).setDate(t.getDate()+("next"===e?7:-7)),v(t),Z({week:t.toISOString().split("T")[0]})}}),(0,r.jsx)(m.T,{statsData:P,currentWeek:b,idleTimeoutMinutes:E,onViewProject:$}),(0,r.jsx)(j.Z,{statsData:P,projectUrls:y,ignoredProjects:U,currentWeek:b,idleTimeoutMinutes:E,onCreateUrl:W,onUpdateUrl:A,onDeleteUrl:M,onRefreshUrls:O,onAddIgnoredProject:V,onRemoveIgnoredProject:Y,selectedProject:T||void 0,onProjectSelect:$,activeTab:N,onTabChange:e=>{Z({tab:e})}})]})}):(0,r.jsx)(o.N,{onValidate:p})}}},e=>{var t=t=>e(e.s=t);e.O(0,[882,135,35,497,954,358],()=>t(24658)),_N_E=e.O()}]);