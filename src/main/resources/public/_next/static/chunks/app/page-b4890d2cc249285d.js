(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{29153:(e,t,s)=>{Promise.resolve().then(s.bind(s,94921))},94921:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var r=s(58081),a=s(82149),n=s(19651),c=s(5160),i=s(22486),o=s(24085),l=s(5064),u=s(38194),d=s(51567),m=s(68299),j=s(49011),g=s(40953),x=s(67552);function h(){let e=(0,n.useRouter)(),t=(0,n.useSearchParams)(),{isLicenseValid:s,isInitializing:h,validateLicense:p,logout:w}=(0,x.Y)(),N=t.get("tab")||"weekly",f=t.get("project"),k=t.get("week"),[b,v]=(0,a.useState)(()=>{if(k){let e=new Date(k);if(!isNaN(e.getTime()))return e}return new Date}),[T,S]=(0,a.useState)(f),y=(0,a.useRef)(!1),{statsData:D,projectUrls:P,ignoredProjects:U,loading:C,error:R,idleTimeoutMinutes:E,setIdleTimeoutMinutes:_,storageType:I,setStorageType:L,settingsLoading:O,fetchStats:W,fetchProjectUrls:A,createProjectUrl:M,updateProjectUrl:V,deleteProjectUrl:Y,addIgnoredProject:Z,removeIgnoredProject:$}=(0,g.u)(s);(0,a.useEffect)(()=>{S(f)},[f]),(0,a.useEffect)(()=>{if(k&&!y.current){let e=new Date(k);isNaN(e.getTime())||k===b.toISOString().split("T")[0]||v(e)}},[k,b]);let q=s=>{y.current=!0;let r=new URLSearchParams(t.toString());s.tab&&r.set("tab",s.tab),void 0!==s.project&&(s.project?r.set("project",s.project):r.delete("project")),s.week&&r.set("week",s.week);let a="".concat(window.location.pathname,"?").concat(r.toString());e.push(a,{scroll:!1}),setTimeout(()=>{y.current=!1},100)},z=e=>{S(e),q({project:e})};return h?(0,r.jsx)(l.U,{}):s?C?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 p-6 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(i.A,{className:"w-8 h-8 animate-spin mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Loading time tracking data..."})]})}):R?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 p-6 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("p",{className:"text-red-600 mb-4",children:["Error: ",R]}),(0,r.jsxs)(c.$,{onClick:W,children:[(0,r.jsx)(i.A,{className:"w-4 h-4 mr-2"}),"Retry"]})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-stone-50 p-6",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,r.jsx)(u.Y,{idleTimeoutMinutes:E,onIdleTimeoutChange:_,storageType:I,onStorageTypeChange:L,onRefresh:W,onLogout:w,settingsLoading:O}),(0,r.jsx)(d.p,{currentWeek:b,onNavigateWeek:e=>{let t;"current"===e?t=new Date:(t=new Date(b)).setDate(t.getDate()+("next"===e?7:-7)),v(t),q({week:t.toISOString().split("T")[0]})}}),(0,r.jsx)(m.T,{statsData:D,currentWeek:b,idleTimeoutMinutes:E,onViewProject:z}),(0,r.jsx)(j.Z,{statsData:D,projectUrls:P,ignoredProjects:U,currentWeek:b,idleTimeoutMinutes:E,onCreateUrl:M,onUpdateUrl:V,onDeleteUrl:Y,onRefreshUrls:A,onAddIgnoredProject:Z,onRemoveIgnoredProject:$,selectedProject:T||void 0,onProjectSelect:z,activeTab:N,onTabChange:e=>{q({tab:e})}})]})}):(0,r.jsx)(o.N,{onValidate:p})}}},e=>{var t=t=>e(e.s=t);e.O(0,[882,135,35,497,954,358],()=>t(29153)),_N_E=e.O()}]);